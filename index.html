<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>„Ç∑„É•„Ç¨„Éº„Éª„Ç≠„É≥„Ç∞„ÉÄ„É† „Äú„Çè„Åü„Åó„Å†„Åë„ÅÆÈ≠îÊ≥ï„Ç±„Éº„Ç≠„Äú</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            font-family: 'Hiragino Sans', '„Éí„É©„ÇÆ„ÉéËßí„Ç¥„Ç∑„ÉÉ„ÇØ', 'Yu Gothic UI', sans-serif;
            background: linear-gradient(135deg, #FFE4E6, #FFF0F5, #E6F3FF);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }
        
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="20" cy="20" r="2" fill="%23FFB6C1" opacity="0.3"><animate attributeName="r" values="2;4;2" dur="3s" repeatCount="indefinite"/></circle><circle cx="60" cy="40" r="1.5" fill="%23DDA0DD" opacity="0.4"><animate attributeName="r" values="1.5;3;1.5" dur="2s" repeatCount="indefinite"/></circle><circle cx="80" cy="70" r="2.5" fill="%23F0E68C" opacity="0.3"><animate attributeName="r" values="2.5;4.5;2.5" dur="4s" repeatCount="indefinite"/></circle></svg>') repeat;
            pointer-events: none;
            z-index: -1;
        }
        
        .container {
            max-width: 390px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .title {
            font-size: 22px;
            font-weight: bold;
            color: #8B4B8C;
            text-shadow: 2px 2px 4px rgba(255, 255, 255, 0.8);
            margin-bottom: 10px;
        }
        
        .subtitle {
            font-size: 14px;
            color: #B85D9B;
            font-style: italic;
        }
        
        .screen {
            display: none;
            animation: fadeIn 0.5s ease-in;
        }
        
        .screen.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .card {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(255, 182, 193, 0.3);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.5);
        }
        
        .question {
            font-size: 18px;
            color: #8B4B8C;
            margin-bottom: 20px;
            text-align: center;
            font-weight: 600;
        }
        
        .choices {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .choice-btn {
            background: linear-gradient(135deg, #FFB6C1, #DDA0DD);
            color: white;
            border: none;
            padding: 15px 20px;
            border-radius: 25px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(221, 160, 221, 0.3);
            touch-action: manipulation;
        }
        
        .choice-btn:hover, .choice-btn:focus {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(221, 160, 221, 0.4);
        }
        
        .choice-btn:active {
            transform: translateY(0);
        }
        
        .cake-display {
            text-align: center;
            padding: 30px;
        }
        
        .cake-image {
            width: 280px;
            height: 280px;
            margin: 0 auto 20px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(221, 160, 221, 0.3);
            background: linear-gradient(135deg, #FFE4E6, #FFF0F5);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 80px;
            border: 3px solid rgba(255, 255, 255, 0.5);
        }
        
        .cake-name {
            font-size: 20px;
            color: #8B4B8C;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .cake-type {
            font-size: 16px;
            color: #B85D9B;
            background: linear-gradient(135deg, rgba(255, 182, 193, 0.3), rgba(221, 160, 221, 0.3));
            padding: 8px 15px;
            border-radius: 20px;
            display: inline-block;
            margin-bottom: 15px;
        }
        
        .cake-description {
            font-size: 14px;
            color: #666;
            line-height: 1.6;
            background: rgba(255, 255, 255, 0.7);
            padding: 15px;
            border-radius: 15px;
            margin-bottom: 20px;
        }
        
        .action-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .btn {
            background: linear-gradient(135deg, #8B4B8C, #B85D9B);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(139, 75, 140, 0.3);
            touch-action: manipulation;
        }
        
        .btn:hover, .btn:focus {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(139, 75, 140, 0.4);
        }
        
        .btn.secondary {
            background: linear-gradient(135deg, #FFB6C1, #DDA0DD);
        }
        
        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(255, 255, 255, 0.5);
            border-radius: 4px;
            margin: 20px 0;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(135deg, #FFB6C1, #DDA0DD);
            border-radius: 4px;
            transition: width 0.3s ease;
        }
        
        .collection-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-top: 20px;
        }
        
        .collection-item {
            background: rgba(255, 255, 255, 0.8);
            border-radius: 15px;
            padding: 15px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(221, 160, 221, 0.2);
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .collection-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(221, 160, 221, 0.3);
        }
        
        .collection-item img {
            width: 80px;
            height: 80px;
            border-radius: 10px;
            margin-bottom: 8px;
        }
        
        .collection-item .name {
            font-size: 12px;
            color: #8B4B8C;
            font-weight: 600;
        }
        
        .tabs {
            display: flex;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 25px;
            padding: 5px;
            margin-bottom: 20px;
        }
        
        .tab {
            flex: 1;
            background: transparent;
            color: #B85D9B;
            border: none;
            padding: 12px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .tab.active {
            background: linear-gradient(135deg, #FFB6C1, #DDA0DD);
            color: white;
            box-shadow: 0 2px 10px rgba(221, 160, 221, 0.3);
        }
        
        .loading {
            text-align: center;
            padding: 40px;
        }
        
        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 4px solid rgba(255, 182, 193, 0.3);
            border-top: 4px solid #FFB6C1;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 15px;
        }
        
        .stat {
            background: rgba(255, 255, 255, 0.5);
            padding: 10px;
            border-radius: 10px;
            text-align: center;
        }
        
        .stat-value {
            font-size: 18px;
            font-weight: bold;
            color: #8B4B8C;
        }
        
        .stat-label {
            font-size: 12px;
            color: #B85D9B;
            margin-top: 2px;
        }
        
        @media (max-width: 350px) {
            .container {
                padding: 15px;
            }
            
            .cake-image {
                width: 240px;
                height: 240px;
                font-size: 60px;
            }
            
            .title {
                font-size: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="title">üç∞ „Ç∑„É•„Ç¨„Éº„Éª„Ç≠„É≥„Ç∞„ÉÄ„É† üç∞</div>
            <div class="subtitle">„Äú„Çè„Åü„Åó„Å†„Åë„ÅÆÈ≠îÊ≥ï„Ç±„Éº„Ç≠„Äú</div>
        </div>
        
        <!-- „Éõ„Éº„É†ÁîªÈù¢ -->
        <div id="home-screen" class="screen active">
            <div class="card">
                <div class="cake-display">
                    <div class="cake-image">üè∞</div>
                    <div class="cake-name">„Éë„ÉÜ„Ç£„Çπ„Éï„Ç£„Ç¢ÁéãÂõΩ„Å∏„Çà„ÅÜ„Åì„Åù</div>
                    <div class="cake-description">
                        „ÅÇ„Å™„Åü„ÅØÊñ∞‰∫∫„Ç±„Éº„Ç≠È≠îÂ∞éÂ£´„ÄÇ<br>
                        ÊÑüÊÉÖ„Çí„Ç±„Éº„Ç≠„Å´Â§âÊèõ„Åô„ÇãÈ≠îÊ≥ï„Çí‰Ωø„Å£„Å¶„ÄÅ<br>
                        ‰∏ñÁïå„Å´‰∏Ä„Å§„Å†„Åë„ÅÆÈ≠îÊ≥ï„Ç±„Éº„Ç≠„ÇíÂâµ„Çä„Åæ„Åó„Çá„ÅÜ„ÄÇ
                    </div>
                    <div class="action-buttons">
                        <button class="btn" onclick="startDiagnosis()">üîÆ ÊÑüÊÉÖË®∫Êñ≠„ÇíÂßã„ÇÅ„Çã</button>
                        <button class="btn secondary" onclick="showCollection()">üìö „Ç±„Éº„Ç≠Âõ≥Èëë</button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Ë®∫Êñ≠ÁîªÈù¢ -->
        <div id="diagnosis-screen" class="screen">
            <div class="card">
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill"></div>
                </div>
                <div class="question" id="question-text"></div>
                <div class="choices" id="choices-container"></div>
            </div>
        </div>
        
        <!-- „É≠„Éº„Éá„Ç£„É≥„Ç∞ÁîªÈù¢ -->
        <div id="loading-screen" class="screen">
            <div class="card">
                <div class="loading">
                    <div class="loading-spinner"></div>
                    <div style="font-size: 18px; color: #8B4B8C; margin-bottom: 10px;">‚ú® È≠îÊ≥ï„Çí„Åã„Åë„Å¶„ÅÑ„Åæ„Åô ‚ú®</div>
                    <div style="font-size: 14px; color: #B85D9B;">„ÅÇ„Å™„Åü„ÅÆÊÑüÊÉÖ„Åå„Ç±„Éº„Ç≠„Å´Â§â„Çè„Å£„Å¶„ÅÑ„Åæ„Åô...</div>
                </div>
            </div>
        </div>
        
        <!-- ÁµêÊûúÁîªÈù¢ -->
        <div id="result-screen" class="screen">
            <div class="card">
                <div class="cake-display">
                    <img id="result-cake-image" class="cake-image" alt="„ÅÇ„Å™„Åü„ÅÆ„Ç±„Éº„Ç≠" 
                         onerror="this.style.display='none'; this.nextElementSibling.style.display='flex'">
                    <div class="cake-image" id="result-cake-fallback" style="display:none;"></div>
                    <div class="cake-name" id="result-cake-name"></div>
                    <div class="cake-type" id="result-cake-type"></div>
                    <div class="cake-description" id="result-cake-description"></div>
                    <div class="stats">
                        <div class="stat">
                            <div class="stat-value" id="stat-sweetness">0</div>
                            <div class="stat-label">Áîò„Åï</div>
                        </div>
                        <div class="stat">
                            <div class="stat-value" id="stat-romance">0</div>
                            <div class="stat-label">„É≠„Éû„É≥„Çπ</div>
                        </div>
                        <div class="stat">
                            <div class="stat-value" id="stat-dream">0</div>
                            <div class="stat-label">Â§¢</div>
                        </div>
                        <div class="stat">
                            <div class="stat-value" id="stat-mystery">0</div>
                            <div class="stat-label">„Éü„Çπ„ÉÜ„É™„Éº</div>
                        </div>
                    </div>
                    <div class="action-buttons">
                        <button class="btn" onclick="saveCake()">üíæ „Ç±„Éº„Ç≠„Çí‰øùÂ≠ò</button>
                        <button class="btn secondary" onclick="shareCake()">üì± „Ç∑„Çß„Ç¢</button>
                        <button class="btn secondary" onclick="goHome()">üè† „Éõ„Éº„É†</button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- „Ç≥„É¨„ÇØ„Ç∑„Éß„É≥ÁîªÈù¢ -->
        <div id="collection-screen" class="screen">
            <div class="card">
                <div class="tabs">
                    <button class="tab active" onclick="showTab('all')">„Åô„Åπ„Å¶</button>
                    <button class="tab" onclick="showTab('romance')">„É≠„Éû„É≥„Çπ</button>
                    <button class="tab" onclick="showTab('dream')">„Éâ„É™„Éº„É†</button>
                    <button class="tab" onclick="showTab('mystery')">„Éü„Çπ„ÉÜ„É™„Éº</button>
                </div>
                <div class="collection-grid" id="collection-grid"></div>
                <div class="action-buttons" style="margin-top: 20px;">
                    <button class="btn secondary" onclick="goHome()">üè† „Éõ„Éº„É†„Å´Êàª„Çã</button>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // „Ç≤„Éº„É†„Éá„Éº„Çø
        const questions = [
            {
                text: "ÊúÄËøë‰∏ÄÁï™ËÄÉ„Åà„Å¶„ÅÑ„Çã„Åì„Å®„ÅØÔºü",
                choices: [
                    { text: "ÊÅãÊÑõ„ÅÆ„Åì„Å®üíï", weights: { sweetness: 20, romance: 30, dream: 10, mystery: 5 } },
                    { text: "Â∞ÜÊù•„ÅÆÂ§¢‚ú®", weights: { sweetness: 15, romance: 5, dream: 30, mystery: 10 } },
                    { text: "ÂèãÈÅî„Å®„ÅÆÈñ¢‰øÇüë≠", weights: { sweetness: 25, romance: 15, dream: 15, mystery: 0 } },
                    { text: "„Å™„Çì„Å®„Å™„Åè‰∏çÂÆâ...üò∞", weights: { sweetness: 5, romance: 5, dream: 5, mystery: 25 } }
                ]
            },
            {
                text: "‰ªä„ÅÆÊ∞óÂàÜ„ÇíËâ≤„Åß‰æã„Åà„Çã„Å®Ôºü",
                choices: [
                    { text: "„Éî„É≥„ÇØüíó", weights: { sweetness: 25, romance: 25, dream: 15, mystery: 0 } },
                    { text: "Ê∞¥Ëâ≤üíô", weights: { sweetness: 15, romance: 10, dream: 25, mystery: 5 } },
                    { text: "Á¥´üíú", weights: { sweetness: 10, romance: 20, dream: 20, mystery: 20 } },
                    { text: "„Ç∞„É¨„Éºü©∂", weights: { sweetness: 5, romance: 0, dream: 5, mystery: 30 } }
                ]
            },
            {
                text: "ÁêÜÊÉ≥„ÅÆ„Éá„Éº„Éà„ÅØÔºü",
                choices: [
                    { text: "ÈÅäÂúíÂú∞„Åß‰∏ÄÊó•‰∏≠üé¢", weights: { sweetness: 30, romance: 20, dream: 20, mystery: 0 } },
                    { text: "„Åä„Åó„ÇÉ„Çå„Å™„Ç´„Éï„Çß„Åß„Åæ„Å£„Åü„Çä‚òï", weights: { sweetness: 20, romance: 25, dream: 15, mystery: 5 } },
                    { text: "Â§úÊôØ„ÅÆË¶ã„Åà„ÇãÂ†¥ÊâÄ„ÅßüåÉ", weights: { sweetness: 15, romance: 30, dream: 25, mystery: 15 } },
                    { text: "‰∏Ä‰∫∫„ÅÆÊôÇÈñì„ÇÇÂ§ßÂàá...ü§î", weights: { sweetness: 10, romance: 5, dream: 15, mystery: 25 } }
                ]
            },
            {
                text: "Â•Ω„Åç„Å™„Çπ„Ç§„Éº„ÉÑ„ÅØÔºü",
                choices: [
                    { text: "„ÅÑ„Å°„Åî„ÅÆ„Ç∑„Éß„Éº„Éà„Ç±„Éº„Ç≠üç∞", weights: { sweetness: 30, romance: 20, dream: 10, mystery: 0 } },
                    { text: "„ÉÅ„Éß„Ç≥„É¨„Éº„Éà„Ç±„Éº„Ç≠üç´", weights: { sweetness: 25, romance: 25, dream: 5, mystery: 10 } },
                    { text: "„É¨„Ç§„É≥„Éú„Éº„Ç±„Éº„Ç≠üåà", weights: { sweetness: 20, romance: 10, dream: 30, mystery: 5 } },
                    { text: "ÊäπËå∂„ÅÆÂíå„Çπ„Ç§„Éº„ÉÑüçÉ", weights: { sweetness: 15, romance: 15, dream: 20, mystery: 20 } }
                ]
            },
            {
                text: "‰ºëÊó•„ÅÆÈÅé„Åî„ÅóÊñπ„ÅØÔºü",
                choices: [
                    { text: "ÂèãÈÅî„Å®„Ç∑„Éß„ÉÉ„Éî„É≥„Ç∞üõçÔ∏è", weights: { sweetness: 25, romance: 15, dream: 15, mystery: 5 } },
                    { text: "‰∏Ä‰∫∫„ÅßÊò†ÁîªÈëëË≥ûüé¨", weights: { sweetness: 10, romance: 15, dream: 25, mystery: 15 } },
                    { text: "ÊÅã‰∫∫„Å®„ÅÆ„Çì„Å≥„Çäüíï", weights: { sweetness: 20, romance: 30, dream: 10, mystery: 5 } },
                    { text: "ÂÆ∂„Åß„Ç¥„É≠„Ç¥„É≠üò¥", weights: { sweetness: 15, romance: 5, dream: 10, mystery: 20 } }
                ]
            },
            {
                text: "È≠îÊ≥ï„Åå‰Ωø„Åà„Åü„Çâ‰Ωï„Çí„Åó„Åü„ÅÑÔºü",
                choices: [
                    { text: "Â•Ω„Åç„Å™‰∫∫„ÅÆÂøÉ„ÇíÁü•„Çä„Åü„ÅÑüí´", weights: { sweetness: 15, romance: 30, dream: 15, mystery: 20 } },
                    { text: "Á©∫„ÇíÈ£õ„Çì„ÅßÂÜíÈô∫„Åó„Åü„ÅÑüïäÔ∏è", weights: { sweetness: 20, romance: 10, dream: 30, mystery: 10 } },
                    { text: "ÁæéÂë≥„Åó„ÅÑ„ÅäËèìÂ≠ê„ÇíÁÑ°Èôê„Å´üç™", weights: { sweetness: 30, romance: 15, dream: 20, mystery: 0 } },
                    { text: "Êú™Êù•„ÇíË¶ã„Å¶„Åø„Åü„ÅÑüîÆ", weights: { sweetness: 5, romance: 10, dream: 25, mystery: 30 } }
                ]
            },
            {
                text: "„Å©„Çì„Å™Áâ©Ë™û„ÅåÂ•Ω„ÅçÔºü",
                choices: [
                    { text: "ÁéãÂ≠êÊßò„Å®„ÅÆÊÅãÊÑõÁâ©Ë™ûüëë", weights: { sweetness: 25, romance: 30, dream: 20, mystery: 5 } },
                    { text: "È≠îÊ≥ïÂ∞ëÂ•≥„ÅÆÂÜíÈô∫üåü", weights: { sweetness: 20, romance: 15, dream: 30, mystery: 10 } },
                    { text: "„Éü„Çπ„ÉÜ„É™„Éº„Éª„Çµ„Çπ„Éö„É≥„ÇπüïµÔ∏è", weights: { sweetness: 5, romance: 10, dream: 10, mystery: 30 } },
                    { text: "Êó•Â∏∏Á≥ª„ÅÆÁôí„ÅóÁâ©Ë™ûüå∏", weights: { sweetness: 30, romance: 20, dream: 15, mystery: 0 } }
                ]
            },
            {
                text: "‰ªä‰∏ÄÁï™Ê¨≤„Åó„ÅÑ„ÇÇ„ÅÆ„ÅØÔºü",
                choices: [
                    { text: "Á¥†Êïµ„Å™ÊÅã‰∫∫üíï", weights: { sweetness: 20, romance: 30, dream: 15, mystery: 5 } },
                    { text: "Â§¢„ÇíÂè∂„Åà„ÇãÂäõ‚ú®", weights: { sweetness: 15, romance: 10, dream: 30, mystery: 15 } },
                    { text: "Â§â„Çè„Çâ„Å™„ÅÑÂèãÊÉÖüë≠", weights: { sweetness: 25, romance: 15, dream: 15, mystery: 5 } },
                    { text: "Êú¨ÂΩì„ÅÆËá™ÂàÜ„ÇíÁü•„Çã„Åì„Å®ü™û", weights: { sweetness: 10, romance: 5, dream: 20, mystery: 30 } }
                ]
            }
        ];
        
        const cakeTypes = [
            {
                name: "„Éî„É•„Ç¢„Éè„Éº„Éà„Ç±„Éº„Ç≠",
                type: "‚ô° „Éî„É•„Ç¢„É≠„Éû„É≥„Çπ",
                emoji: "üíó",
                description: "Á¥îÁ≤ã„Å™ÊÅãÂøÉ„Çí„Åù„ÅÆ„Åæ„Åæ„Ç±„Éº„Ç≠„Å´„Åó„Åæ„Åó„Åü„ÄÇÁîòÈÖ∏„Å£„Å±„ÅÑ„ÅÑ„Å°„Åî„ÅÆÂë≥„Åå„ÄÅÂàùÊÅã„ÅÆÊ∞óÊåÅ„Å°„ÇíÊÄù„ÅÑÂá∫„Åï„Åõ„Å¶„Åè„Çå„Åæ„Åô„ÄÇÊÅã„Å´Á©çÊ•µÁöÑ„Å´„Å™„Çå„ÇãÈ≠îÊ≥ï„ÅåËæº„ÇÅ„Çâ„Çå„Å¶„ÅÑ„Åæ„Åô„ÄÇ",
                image: "assets/illustrations/cakes/pure_heart_cake.png",
                condition: (scores) => scores.romance >= 50 && scores.sweetness >= 40 && scores.mystery <= 30
            },
            {
                name: "„Éâ„É™„Éº„É†„ÇØ„É©„Ç¶„É≥„Ç±„Éº„Ç≠",
                type: "‚ú® „Éâ„É™„Éº„Éü„Éº",
                emoji: "üëë",
                description: "Â§¢Ë¶ã„Çã‰πôÂ•≥„ÅÆÂøÉ„ÇíË°®Áèæ„Åó„Åü„ÄÅÈõ≤„ÅÆ„Çà„ÅÜ„Å´ËªΩ„ÇÑ„Åã„Å™„Ç±„Éº„Ç≠„ÄÇ„ÅÇ„Å™„Åü„ÅÆÈ°ò„ÅÑ„ÇíÊòüÂ∫ß„ÅÆ„Çà„ÅÜ„Å´Áæé„Åó„ÅèÈ£æ„Çä‰ªò„Åë„Åæ„Åó„Åü„ÄÇÂ§¢„ÇíÂè∂„Åà„ÇãÂãáÊ∞ó„Çí„Åè„Çå„ÇãÈ≠îÊ≥ï„ÅÆ„Ç±„Éº„Ç≠„Åß„Åô„ÄÇ",
                image: "assets/illustrations/cakes/dream_crown_cake.png",
                condition: (scores) => scores.dream >= 50 && scores.sweetness >= 30 && scores.mystery <= 40
            },
            {
                name: "„Éü„ÉÉ„Éâ„Éä„Ç§„Éà„Éü„Çπ„ÉÜ„É™„Éº„Ç±„Éº„Ç≠",
                type: "üåô „ÉÄ„Éº„ÇØ„Ç®„É¨„Ç¨„É≥„Éà",
                emoji: "üñ§",
                description: "Ê∑±Â§ú„ÅÆÈùôÂØÇ„Å´ÊΩú„ÇÄ„ÄÅ„ÅÇ„Å™„Åü„ÅÆÂÜÖ„Å™„ÇãË¨é„ÇíË°®Áèæ„Åó„ÅüÂ§ß‰∫∫„ÅÆ„Ç±„Éº„Ç≠„ÄÇ„Éì„Çø„Éº„ÉÅ„Éß„Ç≥„É¨„Éº„Éà„ÅÆÂ••Ê∑±„ÅÑÂë≥„Çè„ÅÑ„Åå„ÄÅË§áÈõë„Å™ÂøÉÂ¢É„ÇíÁâ©Ë™û„Å£„Å¶„ÅÑ„Åæ„Åô„ÄÇÁúüÂÆü„ÇíË¶ãÊäú„ÅèÊ¥ûÂØüÂäõ„ÇíÈ´ò„ÇÅ„ÇãÈ≠îÊ≥ï„ÅåËæº„ÇÅ„Çâ„Çå„Å¶„ÅÑ„Åæ„Åô„ÄÇ",
                image: "assets/illustrations/cakes/midnight_mystery_cake.png",
                condition: (scores) => scores.mystery >= 50 && scores.sweetness <= 40
            },
            {
                name: "„Çπ„Ç§„Éº„Éà„Éï„É¨„É≥„Éâ„Ç∑„ÉÉ„Éó„Ç±„Éº„Ç≠",
                type: "üåà „Éï„É¨„É≥„Éâ„É™„Éº",
                emoji: "üë≠",
                description: "ÂèãÈÅî„Å®„ÅÆÊ•Ω„Åó„ÅÑÊôÇÈñì„ÇíË°®Áèæ„Åó„Åü„ÄÅ„Ç´„É©„Éï„É´„ÅßËèØ„ÇÑ„Åã„Å™„Ç±„Éº„Ç≠„ÄÇ„Åø„Çì„Å™„Åß„Ç∑„Çß„Ç¢„Åô„ÇãÂñú„Å≥„ÅåË©∞„Åæ„Å£„Å¶„ÅÑ„Åæ„Åô„ÄÇÂèãÊÉÖ„ÇíÊ∑±„ÇÅ„ÄÅÊñ∞„Åó„ÅÑÂá∫‰ºö„ÅÑ„ÇíÂºï„ÅçÂØÑ„Åõ„ÇãÈ≠îÊ≥ï„ÅÆ„Ç±„Éº„Ç≠„Åß„Åô„ÄÇ",
                image: "assets/illustrations/cakes/sweet_friendship_cake.png",
                condition: (scores) => scores.sweetness >= 60 && scores.romance <= 40 && scores.mystery <= 30
            },
            {
                name: "„Ç®„É≥„Ç∏„Çß„É´„Ç¶„Ç£„É≥„Ç∞„Ç±„Éº„Ç≠",
                type: "üïäÔ∏è „Çª„É¨„Çπ„ÉÜ„Ç£„Ç¢„É´",
                emoji: "üëº",
                description: "Â§©‰Ωø„ÅÆÁæΩ„Çí„Ç§„É°„Éº„Ç∏„Åó„Åü„ÄÅÁ•ûÁßòÁöÑ„ÅßÁæé„Åó„ÅÑ„Ç±„Éº„Ç≠„ÄÇÁ¥îÁôΩ„ÅÆ„ÇØ„É™„Éº„É†„Å´Èáë„ÅÆË£ÖÈ£æ„ÅåÊñΩ„Åï„Çå„Å¶„ÅÑ„Åæ„Åô„ÄÇÂøÉ„ÇíÊµÑÂåñ„Åó„ÄÅÊñ∞„Åó„ÅÑÂßã„Åæ„Çä„Å∏„ÅÆÂãáÊ∞ó„Çí„Åè„Çå„ÇãÈ≠îÊ≥ï„ÅåËæº„ÇÅ„Çâ„Çå„Å¶„ÅÑ„Åæ„Åô„ÄÇ",
                image: "assets/illustrations/cakes/angel_wing_cake.png",
                condition: (scores) => scores.dream >= 40 && scores.sweetness >= 30 && scores.romance >= 30 && scores.mystery <= 35
            },
            {
                name: "„É≠„Ç§„É§„É´„É©„Éñ„Ç±„Éº„Ç≠",
                type: "üëë „É≠„Ç§„É§„É´„É≠„Éû„É≥„Çπ",
                emoji: "üíé",
                description: "ÁéãÂÆ§„ÅÆËàûË∏è‰ºö„Çí„Ç§„É°„Éº„Ç∏„Åó„ÅüË±™ËèØÁµ¢Áàõ„Å™„Ç±„Éº„Ç≠„ÄÇ„Éê„É©„ÅÆËä±„Å≥„Çâ„Å®ÂÆùÁü≥„ÅÆ„Çà„ÅÜ„Å™Ë£ÖÈ£æ„Åå„ÄÅÈÅãÂëΩ„ÅÆÊÅã„Çí‰∫àÊÑü„Åï„Åõ„Åæ„Åô„ÄÇÁêÜÊÉ≥„ÅÆÊÅã‰∫∫„Å®„ÅÆÂá∫‰ºö„ÅÑ„ÇíÂºï„ÅçÂØÑ„Åõ„ÇãÈ≠îÊ≥ï„ÅÆ„Ç±„Éº„Ç≠„Åß„Åô„ÄÇ",
                image: "assets/illustrations/cakes/royal_love_cake.png",
                condition: (scores) => scores.romance >= 60 && scores.dream >= 30 && scores.sweetness >= 40
            },
            {
                name: "„Ç≥„Ç∫„Éü„ÉÉ„ÇØ„Éâ„É™„Éº„É†„Ç±„Éº„Ç≠",
                type: "üåü „Ç≥„Çπ„É¢„Çπ",
                emoji: "üåå",
                description: "ÂÆáÂÆô„ÅÆÁ•ûÁßò„ÇíË°®Áèæ„Åó„ÅüÂπªÊÉ≥ÁöÑ„Å™„Ç±„Éº„Ç≠„ÄÇÊòüÂ∫ß„ÅÆ„Çà„ÅÜ„Å´Ëºù„Åè„Éà„ÉÉ„Éî„É≥„Ç∞„Åå„ÄÅÁÑ°Èôê„ÅÆÂèØËÉΩÊÄß„ÇíË°®„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇÂ§ß„Åç„Å™Â§¢„ÇíÂè∂„Åà„ÇãÂÆáÂÆôË¶èÊ®°„ÅÆÈ≠îÊ≥ï„ÅåËæº„ÇÅ„Çâ„Çå„Å¶„ÅÑ„Åæ„Åô„ÄÇ",
                image: "assets/illustrations/cakes/cosmic_dream_cake.png",
                condition: (scores) => scores.dream >= 65 && scores.mystery >= 35 && scores.sweetness >= 25
            },
            {
                name: "„Ç∑„Éº„ÇØ„É¨„ÉÉ„Éà„Ç¨„Éº„Éá„É≥„Ç±„Éº„Ç≠",
                type: "üåπ „Ç®„Éã„Ç∞„Éû„ÉÜ„Ç£„ÉÉ„ÇØ",
                emoji: "üóùÔ∏è",
                description: "ÁßòÂØÜ„ÅÆËä±Âúí„Çí„Ç§„É°„Éº„Ç∏„Åó„Åü„ÄÅË¨é„ÇÅ„ÅÑ„ÅüÁæé„Åó„Åï„ÅÆ„Ç±„Éº„Ç≠„ÄÇÈö†„Åï„Çå„ÅüÊââ„ÅÆ„Çà„ÅÜ„Å™Ë£ÖÈ£æ„Åå„ÄÅ„ÅÇ„Å™„Åü„ÅÆÂÜÖ„Å™„ÇãÁßòÂØÜ„ÇíÂÆà„Çä„Åæ„Åô„ÄÇÈö†„Åï„Çå„ÅüÊâçËÉΩ„ÇíÈñãËä±„Åï„Åõ„ÇãÈ≠îÊ≥ï„ÅÆ„Ç±„Éº„Ç≠„Åß„Åô„ÄÇ",
                image: "assets/illustrations/cakes/secret_garden_cake.png",
                condition: (scores) => scores.mystery >= 45 && scores.dream >= 35 && scores.romance >= 25
            },
            {
                name: "„Éè„Éº„Éà„Éï„É´„Çπ„Éû„Ç§„É´„Ç±„Éº„Ç≠",
                type: "üòä „Éè„ÉÉ„Éî„Éº",
                emoji: "üåª",
                description: "Â§™ÈôΩ„ÅÆ„Çà„ÅÜ„Å™Êòé„Çã„ÅÑÁ¨ëÈ°î„Çí„Ç§„É°„Éº„Ç∏„Åó„Åü„ÄÅÂÖÉÊ∞ó„ÅÑ„Å£„Å±„ÅÑ„ÅÆ„Ç±„Éº„Ç≠„ÄÇÈ£ü„Åπ„Çã‰∫∫„ÇíËá™ÁÑ∂„Å®Á¨ëÈ°î„Å´„Åó„Å¶„Åó„Åæ„ÅÜÈ≠îÊ≥ï„ÅåËæº„ÇÅ„Çâ„Çå„Å¶„ÅÑ„Åæ„Åô„ÄÇ„Éù„Ç∏„ÉÜ„Ç£„Éñ„Å™„Ç®„Éç„É´„ÇÆ„Éº„ÇíÂë®„Çä„Å´Â∫É„Åí„Çã„Ç±„Éº„Ç≠„Åß„Åô„ÄÇ",
                image: "assets/illustrations/cakes/heartful_smile_cake.png",
                condition: (scores) => scores.sweetness >= 50 && scores.romance >= 25 && scores.dream >= 25 && scores.mystery <= 30
            },
            {
                name: "„Éà„ÉØ„Ç§„É©„Ç§„Éà„ÇΩ„Ç¶„É´„Ç±„Éº„Ç≠",
                type: "üåÜ „ÇΩ„Ç¶„É´„Éï„É´",
                emoji: "üåô",
                description: "Â§ïÊöÆ„ÇåÊôÇ„ÅÆÂàá„Å™„ÅÑÁæé„Åó„Åï„ÇíË°®Áèæ„Åó„Åü„ÄÅÂ§ß‰∫∫„ÅÆÈ≠ÖÂäõ„ÅÇ„Åµ„Çå„Çã„Ç±„Éº„Ç≠„ÄÇË§áÈõë„Å™ÊÑüÊÉÖ„ÇíÂèó„ÅëÂÖ•„Çå„ÇãÂøÉ„ÅÆ‰ΩôË£ï„ÇíËÇ≤„Å¶„ÇãÈ≠îÊ≥ï„ÅåËæº„ÇÅ„Çâ„Çå„Å¶„ÅÑ„Åæ„Åô„ÄÇÂÜÖÈù¢„ÅÆÁæé„Åó„Åï„ÇíÂºï„ÅçÂá∫„Åô„Ç±„Éº„Ç≠„Åß„Åô„ÄÇ",
                image: "assets/illustrations/cakes/twilight_soul_cake.png",
                condition: (scores) => scores.mystery >= 40 && scores.romance >= 35 && scores.dream >= 25 && scores.sweetness <= 45
            },
            {
                name: "„Éï„Ç°„É≥„Çø„Ç∏„Ç¢„Ç±„Éº„Ç≠",
                type: "üé≠ „Éï„Ç°„É≥„Çø„Ç∏„ÉÉ„ÇØ",
                emoji: "üé™",
                description: "„Åä„Å®„ÅéË©±„ÅÆ‰∏ñÁïå„Åã„ÇâÈ£õ„Å≥Âá∫„Åó„Åü„Çà„ÅÜ„Å™„ÄÅ‰∏çÊÄùË≠∞„ÅßÊ•Ω„Åó„ÅÑ„Ç±„Éº„Ç≠„ÄÇÁèæÂÆü„Å®Á©∫ÊÉ≥„ÅÆÂ¢ÉÁïå„ÇíÊõñÊòß„Å´„Åô„ÇãÈ≠îÊ≥ï„ÅåËæº„ÇÅ„Çâ„Çå„Å¶„ÅÑ„Åæ„Åô„ÄÇÊÉ≥ÂÉèÂäõ„ÇíÁÑ°Èôê„Å´Â∫É„Åí„Çã„Ç±„Éº„Ç≠„Åß„Åô„ÄÇ",
                image: "assets/illustrations/cakes/fantasia_cake.png",
                condition: (scores) => scores.dream >= 55 && scores.sweetness >= 35 && scores.mystery >= 30 && scores.romance <= 40
            },
            {
                name: "„Ç®„É¨„Ç¨„É≥„Éà„É≠„Éº„Ç∫„Ç±„Éº„Ç≠",
                type: "üåπ „Ç®„É¨„Ç¨„É≥„Éà",
                emoji: "ü•Ä",
                description: "Ê∞óÂìÅ„ÅÇ„ÇãÂ§ß‰∫∫„ÅÆÂ•≥ÊÄß„Çí„Ç§„É°„Éº„Ç∏„Åó„Åü„ÄÅ‰∏äÂìÅ„ÅßÊ¥óÁ∑¥„Åï„Çå„Åü„Ç±„Éº„Ç≠„ÄÇÊ∑±Á¥Ö„ÅÆ„Éê„É©„ÅåÂ§ß‰∫∫„ÅÆÈ≠ÖÂäõ„ÇíË°®Áèæ„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇËá™‰ø°„Å®ÂìÅÊ†º„ÇíË∫´„Å´„Å§„Åë„ÇãÈ≠îÊ≥ï„ÅÆ„Ç±„Éº„Ç≠„Åß„Åô„ÄÇ",
                image: "assets/illustrations/cakes/elegant_rose_cake.png",
                condition: (scores) => scores.romance >= 45 && scores.mystery >= 35 && scores.sweetness >= 25 && scores.dream <= 45
            },
            {
                name: "„Éó„É™„É≥„Çª„Çπ„ÉÜ„Ç£„Ç¢„É©„Ç±„Éº„Ç≠",
                type: "üë∏ „Éó„É™„É≥„Çª„Çπ",
                emoji: "‚ú®",
                description: "„ÅäÂß´Êßò„ÅÆÂ§¢„ÇíÂè∂„Åà„Çã„ÄÅ„Åç„Çâ„ÇÅ„Åè„ÉÜ„Ç£„Ç¢„É©„ÅÆ„Çà„ÅÜ„Å™„Ç±„Éº„Ç≠„ÄÇ„ÅÇ„Å™„Åü„ÅÆ‰∏≠„Å´Áú†„ÇãÊ∞óÂìÅ„Å®ÂÑ™ÈõÖ„Åï„ÇíÂºï„ÅçÂá∫„Åó„Åæ„Åô„ÄÇËá™ÂàÜ„ÇíÂ§ßÂàá„Å´„Åó„ÄÅÊÑõ„Åï„Çå„ÇãÈ≠ÖÂäõ„ÇíÈ´ò„ÇÅ„ÇãÈ≠îÊ≥ï„ÅÆ„Ç±„Éº„Ç≠„Åß„Åô„ÄÇ",
                image: "assets/illustrations/cakes/princess_tiara_cake.png",
                condition: (scores) => scores.sweetness >= 45 && scores.romance >= 40 && scores.dream >= 40 && scores.mystery <= 35
            },
            {
                name: "„É†„Éº„É≥„É©„Ç§„Éà„Éâ„É™„Éº„É†„Ç±„Éº„Ç≠",
                type: "üåô „É´„Éä„ÉÜ„Ç£„ÉÉ„ÇØ",
                emoji: "ü¶ã",
                description: "Êúà„ÅÆÂÖâ„Å´ÁÖß„Çâ„Åï„Çå„ÅüÂ§ú„ÅÆÂ§¢„Çí„Ç§„É°„Éº„Ç∏„Åó„ÅüÂπªÊÉ≥ÁöÑ„Å™„Ç±„Éº„Ç≠„ÄÇËù∂„ÅÆÁæΩ„ÅÆ„Çà„ÅÜ„Å™ÁπäÁ¥∞„Å™Ë£ÖÈ£æ„ÅåÁæé„Åó„ÅèËàû„Å£„Å¶„ÅÑ„Åæ„Åô„ÄÇÊΩúÂú®ÊÑèË≠ò„Å´Èö†„Åï„Çå„ÅüÈ°ò„ÅÑ„ÇíÁèæÂÆüÂåñ„Åô„ÇãÈ≠îÊ≥ï„ÅÆ„Ç±„Éº„Ç≠„Åß„Åô„ÄÇ",
                image: "assets/illustrations/cakes/moonlight_dream_cake.png",
                condition: (scores) => scores.dream >= 50 && scores.mystery >= 40 && scores.romance >= 30 && scores.sweetness <= 50
            },
            {
                name: "„Éè„Éº„É¢„Éã„Éº„Éñ„É≠„ÉÉ„Çµ„É†„Ç±„Éº„Ç≠",
                type: "üå∏ „Éè„Éº„É¢„Éã„Éº",
                emoji: "üå∫",
                description: "ÂøÉ„ÅÆË™øÂíå„ÇíË°®Áèæ„Åó„Åü„ÄÅ„Éê„É©„É≥„Çπ„ÅÆÂèñ„Çå„ÅüÁæé„Åó„ÅÑ„Ç±„Éº„Ç≠„ÄÇÊ°ú„ÅÆËä±„Å≥„Çâ„ÅåÂøÉ„ÅÆÂπ≥Á©è„ÇíË°®„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇÂÜÖÈù¢„ÅÆË™øÂíå„Çí‰øù„Å°„ÄÅ‰∫∫ÈñìÈñ¢‰øÇ„ÇíÂÜÜÊªë„Å´„Åô„ÇãÈ≠îÊ≥ï„ÅÆ„Ç±„Éº„Ç≠„Åß„Åô„ÄÇ",
                image: "assets/illustrations/cakes/harmony_blossom_cake.png",
                condition: (scores) => {
                    const total = scores.sweetness + scores.romance + scores.dream + scores.mystery;
                    const balanced = Math.abs(scores.sweetness - total/4) <= 15 && 
                                   Math.abs(scores.romance - total/4) <= 15 && 
                                   Math.abs(scores.dream - total/4) <= 15 && 
                                   Math.abs(scores.mystery - total/4) <= 15;
                    return balanced;
                }
            },
            {
                name: "„Ç§„É≥„Éï„Ç£„Éã„ÉÜ„Ç£„Ç±„Éº„Ç≠",
                type: "‚àû „Ç§„É≥„Éï„Ç£„Éã„ÉÉ„Éà",
                emoji: "‚ôæÔ∏è",
                description: "ÁÑ°Èôê„ÅÆÂèØËÉΩÊÄß„ÇíÁßò„ÇÅ„ÅüÁ©∂Ê•µ„ÅÆ„Ç±„Éº„Ç≠„ÄÇ„ÅÇ„Å™„Åü„ÅÆÂÖ®„Å¶„ÅÆÈù¢„ÅåÂÆåÁíß„Å´Ë™øÂíå„Åó„Åü„ÄÅ„Åæ„Åï„Å´Â•áË∑°„ÅÆÂâµ‰Ωú„Åß„Åô„ÄÇ„Åô„Åπ„Å¶„ÅÆÈ°ò„ÅÑ„ÇíÂè∂„Åà„ÇãÁÑ°Èôê„ÅÆÈ≠îÊ≥ï„ÅåËæº„ÇÅ„Çâ„Çå„Å¶„ÅÑ„Åæ„Åô„ÄÇ",
                image: "assets/illustrations/cakes/infinity_cake.png",
                condition: (scores) => scores.sweetness >= 80 && scores.romance >= 80 && scores.dream >= 80 && scores.mystery >= 60
            }
        ];
        
        // „Ç≤„Éº„É†Áä∂ÊÖã
        let currentQuestion = 0;
        let scores = { sweetness: 0, romance: 0, dream: 0, mystery: 0 };
        let userCakes = JSON.parse(localStorage.getItem('userCakes') || '[]');
        let currentCake = null;
        
        function startDiagnosis() {
            currentQuestion = 0;
            scores = { sweetness: 0, romance: 0, dream: 0, mystery: 0 };
            showScreen('diagnosis-screen');
            showQuestion();
        }
        
        function showQuestion() {
            const question = questions[currentQuestion];
            const progressPercent = (currentQuestion / questions.length) * 100;
            
            document.getElementById('progress-fill').style.width = progressPercent + '%';
            document.getElementById('question-text').textContent = question.text;
            
            const container = document.getElementById('choices-container');
            container.innerHTML = '';
            
            question.choices.forEach((choice, index) => {
                const button = document.createElement('button');
                button.className = 'choice-btn';
                button.textContent = choice.text;
                button.onclick = () => selectChoice(choice.weights);
                container.appendChild(button);
            });
        }
        
        function selectChoice(weights) {
            Object.keys(weights).forEach(key => {
                scores[key] += weights[key];
            });
            
            currentQuestion++;
            
            if (currentQuestion < questions.length) {
                showQuestion();
            } else {
                generateResult();
            }
        }
        
        function generateResult() {
            showScreen('loading-screen');
            
            setTimeout(() => {
                const resultCake = determineCakeType(scores);
                currentCake = {
                    ...resultCake,
                    scores: { ...scores },
                    createdAt: new Date().toISOString()
                };
                
                displayResult(currentCake);
                showScreen('result-screen');
            }, 3000);
        }
        
        function determineCakeType(scores) {
            for (let cakeType of cakeTypes) {
                if (cakeType.condition(scores)) {
                    return cakeType;
                }
            }
            return cakeTypes[8]; // „Éá„Éï„Ç©„É´„Éà: „Éè„Éº„Éà„Éï„É´„Çπ„Éû„Ç§„É´„Ç±„Éº„Ç≠
        }
        
        function displayResult(cake) {
            const imageElement = document.getElementById('result-cake-image');
            const fallbackElement = document.getElementById('result-cake-fallback');
            
            imageElement.src = cake.image;
            fallbackElement.innerHTML = cake.emoji;
            
            document.getElementById('result-cake-name').textContent = cake.name;
            document.getElementById('result-cake-type').textContent = cake.type;
            document.getElementById('result-cake-description').textContent = cake.description;
            
            document.getElementById('stat-sweetness').textContent = cake.scores.sweetness;
            document.getElementById('stat-romance').textContent = cake.scores.romance;
            document.getElementById('stat-dream').textContent = cake.scores.dream;
            document.getElementById('stat-mystery').textContent = cake.scores.mystery;
        }
        
        function saveCake() {
            if (currentCake) {
                userCakes.push(currentCake);
                localStorage.setItem('userCakes', JSON.stringify(userCakes));
                alert('„Ç±„Éº„Ç≠„ÇíÂõ≥Èëë„Å´‰øùÂ≠ò„Åó„Åæ„Åó„ÅüÔºÅ‚ú®');
            }
        }
        
        function shareCake() {
            if (currentCake) {
                const shareText = `ÁßÅ„ÅÆÈ≠îÊ≥ï„Ç±„Éº„Ç≠„ÅØ„Äå${currentCake.name}„Äç(${currentCake.type})„Åß„Åó„ÅüÔºÅ\n\n${currentCake.description}\n\n#„Ç∑„É•„Ç¨„Éº„Ç≠„É≥„Ç∞„ÉÄ„É† #È≠îÊ≥ï„Ç±„Éº„Ç≠`;
                
                if (navigator.share) {
                    navigator.share({
                        title: '„Ç∑„É•„Ç¨„Éº„Éª„Ç≠„É≥„Ç∞„ÉÄ„É†',
                        text: shareText,
                        url: window.location.href
                    });
                } else {
                    navigator.clipboard.writeText(shareText + '\n' + window.location.href);
                    alert('„Ç∑„Çß„Ç¢Áî®„ÉÜ„Ç≠„Çπ„Éà„Çí„Ç≥„Éî„Éº„Åó„Åæ„Åó„ÅüÔºÅ');
                }
            }
        }
        
        function showCollection() {
            showScreen('collection-screen');
            displayCollection('all');
        }
        
        function showTab(category) {
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            event.target.classList.add('active');
            displayCollection(category);
        }
        
        function displayCollection(category) {
            const grid = document.getElementById('collection-grid');
            grid.innerHTML = '';
            
            let cakesToShow = userCakes;
            if (category !== 'all') {
                cakesToShow = userCakes.filter(cake => {
                    switch(category) {
                        case 'romance': return cake.scores.romance >= 40;
                        case 'dream': return cake.scores.dream >= 40;
                        case 'mystery': return cake.scores.mystery >= 40;
                        default: return true;
                    }
                });
            }
            
            if (cakesToShow.length === 0) {
                grid.innerHTML = '<div style="grid-column: 1 / -1; text-align: center; padding: 40px; color: #B85D9B;">„Åæ„Å†„Ç±„Éº„Ç≠„Åå„ÅÇ„Çä„Åæ„Åõ„Çì<br>Ë®∫Êñ≠„Åó„Å¶„Ç±„Éº„Ç≠„Çí‰Ωú„Å£„Å¶„Åø„Åæ„Åó„Çá„ÅÜÔºÅ</div>';
                return;
            }
            
            cakesToShow.forEach(cake => {
                const item = document.createElement('div');
                item.className = 'collection-item';
                item.innerHTML = `
                    <img src="${cake.image}" alt="${cake.name}" onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                    <div style="width: 80px; height: 80px; border-radius: 10px; display: none; align-items: center; justify-content: center; font-size: 32px; background: linear-gradient(135deg, #FFE4E6, #FFF0F5);">${cake.emoji}</div>
                    <div class="name">${cake.name}</div>
                `;
                grid.appendChild(item);
            });
        }
        
        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            document.getElementById(screenId).classList.add('active');
        }
        
        function goHome() {
            showScreen('home-screen');
        }
        
        // ÂàùÊúüÂåñ
        document.addEventListener('DOMContentLoaded', function() {
            // „Çø„ÉÉ„ÉÅÊìç‰Ωú„ÅÆÊúÄÈÅ©Âåñ
            document.addEventListener('touchstart', function() {}, true);
        });
    </script>
</body>
</html>